/*
 Angular Resource Tastypie v1.0.0
 (c) 2014 Marcos W. Ferretti, http://br.linkedin.com/in/mwferretti/
 License: MIT
*/
function TastypieProvider(g){g.defaults.useXDomain=!0;delete g.defaults.headers.common["X-Requested-With"];g.defaults.headers.common["Content-Type"]="application/json";var k="",d="",a={username:"",api_key:""},e={};this.setResourceUrl=function(a){k=a;a=document.createElement("a");a.href=k;d=a.protocol+"//"+a.hostname;""!=a.port&&(d=d+":"+a.port)};this.setAuth=function(d,c){a.username=d;a.api_key=c;g.defaults.headers.common.Authorization="ApiKey "+a.username+":"+a.api_key};this.getRoutesException=function(){return e};
this.setRoutesException=function(a){if(!a)throw"[$tastypie] Arg0 [data] is required.";if(!angular.isObject(a))throw"[$tastypie] Arg0 [data] is not object.";e=a};this.getAuth=function(){return a};this.getResourceUrl=function(){return k};this.getResourceDomain=function(){return d};this.$get=function(){return{resource_url:this.getResourceUrl(),resource_domain:this.getResourceDomain(),auth:this.getAuth(),routes_exception:this.getRoutesException(),setAuth:this.setAuth,setResourceUrl:this.setResourceUrl,
setRoutesException:this.setRoutesException}}}function RouteExceptionService(g,k){var d={};this.redirect=function(a){d=k.routes_exception;if(!d.hasOwnProperty(String(a)))return!1;g.path(d[String(a)]);return!0}}
function TastypiePaginatorFactory(g,k,d){function a(c,a,b){this.resource=c;this.filters=a||{};this.meta={};this.objects=[];this.len=this.index=0;this.range=[];e(this,b)}function e(c,a){if(!angular.isObject(a.meta))throw"[$tastypiePaginator] Invalid django-tastypie object.";c.meta=a.meta;angular.forEach(a.objects,function(b,f){a.objects[f]=c.resource.objects.$create(b)});c.objects=a.objects;c.len=Math.ceil(a.meta.total_count/a.meta.limit);c.index=0==a.meta.offset?1:Math.ceil(a.meta.offset/a.meta.limit)+
1;for(var b=[],f=1;f<=c.len;f++)b.push(f);c.range=b}function l(a,c){c&&g(c).get().$promise.then(function(c){e(a,c)},function(c){if(!d.redirect(c.status))throw"[$tastypiePaginator] ".concat(c.statusText);})}function c(a,h,b){(h!=a.index||b)&&0<h&&h<=a.len&&(b=angular.copy(a.filters),b.offset=(h-1)*a.meta.limit,g(a.resource.endpoint,a.resource.defaults).get(b).$promise.then(function(b){b.meta.offset==b.meta.total_count?c(a,h-1,!0):e(a,b)},function(a){if(!d.redirect(a.status))throw"[$tastypiePaginator] ".concat(a.statusText);
}))}a.prototype.change=function(a){a&&c(this,a,!1)};a.prototype.next=function(){this.meta.next&&l(this,k.resource_domain+this.meta.next)};a.prototype.previous=function(){this.meta.previous&&l(this,k.resource_domain+this.meta.previous)};a.prototype.refresh=function(){c(this,this.index,!0)};a.prototype.first=function(){c(this,1,!1)};a.prototype.last=function(){c(this,this.len,!1)};return a}
function TastypieObjectsFactory(g,k,d){function a(a){this.resource=a}function e(a,e){var h=g(a.resource.endpoint,{id:"@id"},{post:{method:"POST"},save:{method:"POST"},get:{method:"GET",url:a.resource.endpoint+":id%2f"},get_uri:{method:"GET",url:a.resource.endpoint+":id%2f"},update:{method:"PUT",url:a.resource.endpoint+":id%2f"},put:{method:"PUT",url:a.resource.endpoint+":id%2f"},"delete":{method:"DELETE",url:a.resource.endpoint+":id%2f"},remove:{method:"DELETE",url:a.resource.endpoint+":id%2f"}});
delete h.prototype.$query;h.prototype.$get=function(a){a=a||this;if(!a.hasOwnProperty("id"))throw"[$tastypieObjects] Attribute [id] is required.";a=this.$get_uri(a);a.then(null,function(a){if(!d.redirect(a.status))throw"[$tastypieObjects] ".concat(a.statusText);});return a};h.prototype.$save=function(){var b=null,b=this.hasOwnProperty("id")?this.$update():this.$post();b.then(function(b){typeof a.resource.page.refresh==typeof Function&&a.resource.page.refresh()},function(a){if(!d.redirect(a.status))throw"[$tastypieObjects] ".concat(a.statusText);
});return b};h.prototype.$update=function(b){b=b||this;if(!b.hasOwnProperty("id"))throw"[$tastypieObjects] Attribute [id] is required.";var f=null,f=this.$put(b);f.then(function(b){typeof a.resource.page.refresh==typeof Function&&a.resource.page.refresh()},function(a){if(!d.redirect(a.status))throw"[$tastypieObjects] ".concat(a.statusText);});return f};h.prototype.$delete=function(b){b=b||this;var f=this;if(!b.hasOwnProperty("id"))throw"[$tastypieObjects] Attribute [id] is required.";return this.$remove(b).then(function(){angular.forEach(f,
function(a,c){delete f[c]});typeof a.resource.page.refresh==typeof Function&&a.resource.page.refresh()},function(a){if(!d.redirect(a.status))throw"[$tastypieObjects] ".concat(a.statusText);})};h.prototype.$clear=function(){var a=this;angular.forEach(a,function(c,d){delete a[d]})};return new h(e)}function l(a){var e=g(a.resource.endpoint,a.resource.defaults,{get:{method:"GET"},find:{method:"GET"}});delete e.prototype.$query;delete e.prototype.$save;e.prototype.$find=function(e){var b=this.$get(e),
f=this;b.then(function(b){a.resource.page=new k(a.resource,e,b);f.page=a.resource.page;delete f.meta;delete f.objects},function(b){a.resource.page={};f.page={};if(!d.redirect(b.status))throw"[$tastypieObjects] ".concat(b.statusText);});return b};return new e}a.prototype.$create=function(a){return e(this,a)};a.prototype.$get=function(a){return e(this,a).$get()};a.prototype.$delete=function(a){return e(this,a).$delete()};a.prototype.$find=function(a){return l(this).$find(a)};a.prototype.$update=function(a){return e(this,
a).$update()};return a}function TastypieResourceFactory(g,k,d,a){return function(e,d){if(!e)throw"[$tastypieResource] Unknown service name.";this.endpoint=k.resource_url+e+"%2f";this.defaults=d||{};this.page={};this.objects=new a(this)}}var ResourceTastypieModule=angular.module("ngResourceTastypie",["ngResource"]);TastypieProvider.$inject=["$httpProvider"];ResourceTastypieModule.provider("$tastypie",TastypieProvider);RouteExceptionService.$inject=["$location","$tastypie"];
ResourceTastypieModule.service("$RouteException",RouteExceptionService);TastypiePaginatorFactory.$inject=["$resource","$tastypie","$RouteException"];ResourceTastypieModule.factory("$tastypiePaginator",TastypiePaginatorFactory);TastypieObjectsFactory.$inject=["$resource","$tastypiePaginator","$RouteException"];ResourceTastypieModule.factory("$tastypieObjects",TastypieObjectsFactory);TastypieResourceFactory.$inject=["$resource","$tastypie","$tastypiePaginator","$tastypieObjects"];
ResourceTastypieModule.factory("$tastypieResource",TastypieResourceFactory);
